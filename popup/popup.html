<!DOCTYPE html>
<!--
  Anki Word Assistant - Modern UI
-->
<html>
	<head>
		<meta charset="UTF-8" />
		<title data-i18n="popup_app_title"></title>
		<link rel="stylesheet" href="../styles/tailwind.min.css" />
		<link rel="stylesheet" href="../styles/custom-classes.css" />
		<script type="module" src="../utils/i18n.js"></script>
		<style>
			/* Extra custom styles for scrollbar hiding/styling if needed */
			::-webkit-scrollbar {
				width: 6px;
				height: 6px;
			}
			::-webkit-scrollbar-track {
				background: transparent;
			}
			::-webkit-scrollbar-thumb {
				background: rgba(148, 163, 184, 0.4);
				border-radius: 99px;
			}
			::-webkit-scrollbar-thumb:hover {
				background: rgba(148, 163, 184, 0.6);
			}
		</style>
	</head>
	<body class="bg-page text-main font-sans antialiased overflow-hidden">
		<!-- Main Container -->
		<div class="w-96 h-[580px] flex flex-col relative">
			<!-- Header: Glassy & Clean -->
			<header
				class="flex-none px-5 py-4 bg-page/90 backdrop-blur-md border-b border-white/10 z-10 flex items-center justify-between sticky top-0 shadow-sm">
				<h1
					class="text-lg font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary-600 to-primary-400"
					data-i18n="popup_app_title">
					Anki Assistant
				</h1>
				<!-- Status Indicator -->
				<div class="flex items-center space-x-2">
					<p
						id="status-message"
						class="text-xs font-medium text-secondary truncate max-w-[120px] transition-colors duration-300"></p>
					<div
						id="status-dot"
						class="w-2 h-2 rounded-full bg-slate-300 transition-colors duration-300"></div>
				</div>
			</header>

			<!-- Template Selector Section -->
			<div
				class="flex-none px-4 py-3 bg-page/50 border-b border-border-light/50">
				<div
					class="bg-card/60 rounded-lg p-1 flex items-center shadow-subtle border border-border-light group focus-within:ring-2 focus-within:ring-primary/20 transition-all">
					<label
						for="template-select"
						class="pl-3 pr-2 text-xs font-semibold text-secondary whitespace-nowrap"
						data-i18n="popup_template_selector_label"></label>
					<select
						id="template-select"
						class="flex-1 bg-transparent text-sm text-main py-1.5 focus:outline-none cursor-pointer appearance-none">
						<option value="" data-i18n="popup_template_loading">
							Loading...
						</option>
					</select>
					<div class="pr-2 pointer-events-none text-tertiary">
						<svg
							class="w-4 h-4"
							fill="none"
							stroke="currentColor"
							viewBox="0 0 24 24">
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								stroke-width="2"
								d="M19 9l-7 7-7-7"></path>
						</svg>
					</div>
				</div>

				<!-- Notifications -->
				<div
					id="template-change-notice"
					class="hidden mt-2 p-2.5 rounded-lg bg-yellow-50/80 border border-yellow-200/50 text-yellow-700 text-xs flex items-start gap-2 backdrop-blur-sm animate-fade-in">
					<svg
						class="w-4 h-4 flex-shrink-0 mt-0.5 text-yellow-500"
						fill="none"
						viewBox="0 0 24 24"
						stroke="currentColor">
						<path
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="2"
							d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
					</svg>
					<span data-i18n="popup_template_change_notice"
						>Template changed, please re-parse.</span
					>
				</div>

				<div
					id="template-empty-state"
					class="hidden mt-2 p-3 rounded-lg bg-blue-50/80 border border-blue-100 text-blue-700 text-xs flex items-center justify-between backdrop-blur-sm animate-fade-in">
					<span data-i18n="popup_template_empty_state"
						>No template configured.</span
					>
					<button
						id="open-options-btn"
						class="text-xs px-2 py-1 bg-white rounded shadow-sm hover:shadow text-blue-600 font-semibold transition-all"
						data-i18n="popup_template_open_options">
						Settings
					</button>
				</div>
			</div>

			<!-- Main Content Area -->
			<main class="flex-grow overflow-y-auto px-4 py-4 space-y-5 scroll-smooth">
				<!-- Input Section -->
				<div class="input-section group">
					<div class="flex justify-between items-center mb-2">
						<label
							class="text-xs font-bold text-secondary uppercase tracking-wider"
							data-i18n="popup_input_label"></label>
						<!-- Perhaps a character count or clear button could go here later -->
					</div>
					<div class="relative">
						<textarea
							id="text-input"
							rows="2"
							data-i18n-placeholder="popup_input_placeholder"
							data-i18n-aria="popup_input_label"
							class="w-full p-3 bg-card border border-border-light rounded-xl shadow-subtle resize-none text-sm leading-relaxed text-main placeholder-tertiary focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary-400 transition-all duration-200 ease-out min-h-[80px]"></textarea>

						<!-- Parse Button (Floating overlapping or just below with nice spacing) -->
						<!-- We keep it separate as per original structure but styling it better -->
					</div>
				</div>

				<!-- Parse Action -->
				<div class="action-section">
					<button
						id="parse-btn"
						data-i18n="popup_parse_button"
						data-i18n-aria="popup_parse_button"
						class="w-full py-2.5 px-4 bg-white border border-border-light text-secondary font-semibold rounded-xl shadow-sm hover:bg-primary-50 hover:text-primary-700 hover:border-primary-200 hover:shadow-md hover:-translate-y-0.5 active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-primary/30 transition-all duration-200 flex items-center justify-center gap-2">
						<!-- Icon can be added via CSS or innerHTML if script allows, but keeping text for safety -->
					</button>
				</div>

				<!-- Results Section -->
				<div id="fields-container" class="space-y-4 pb-4">
					<!-- Dynamic Content -->
				</div>
			</main>

			<!-- Footer / Write Section -->
			<div
				class="flex-none p-4 bg-white/80 backdrop-blur-xl border-t border-border-light z-20">
				<button
					id="write-btn"
					data-i18n="popup_write_button"
					data-i18n-aria="popup_write_button"
					disabled
					class="w-full py-3 px-4 bg-primary text-white font-bold rounded-xl shadow-lg shadow-primary/30 hover:bg-primary-600 hover:shadow-primary/40 hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none disabled:bg-slate-300 disabled:text-slate-500 disabled:hover:translate-y-0 active:scale-[0.98] transition-all duration-200 flex items-center justify-center gap-2"></button>
			</div>
		</div>

		<script type="module" src="popup.js"></script>
	</body>
</html>
