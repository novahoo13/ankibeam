# 📖 AnkiBeam ユーザーマニュアル

**バージョン**：1.0  
**最終更新**：2026 年 1 月

---

## 目次

1. [クイックスタート](#1-クイックスタート)
2. [インストールとセットアップ](#2-インストールとセットアップ)
3. [使い方](#3-使い方)
4. [テンプレート設定](#4-テンプレート設定)
5. [高度な機能](#5-高度な機能)
6. [よくある質問](#6-よくある質問)

---

## 1. クイックスタート

### AnkiBeam とは

AnkiBeam は Chrome ブラウザの拡張機能で、以下のことができます：

✅ **自動解析** - 単語を入力すると、AIが自動的に意味、例文、発音などを生成  
✅ **ワンクリックカード作成** - 解析結果を直接 Anki に同期  
✅ **Web ハイライト** - 任意のWebページでテキストを選択すると、フローティングパネルが即座に表示

### ワークフロー

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│   📝 テキスト入力     🤖 AI 解析         📚 Anki に書き込み │
│                                                             │
│   "vocabulary"   ──►   Word: vocabulary    ──►   ✅ 成功    │
│                        Reading: /vəˈkæbjəleri/              │
│                        Meaning: 語彙リスト                   │
│                        Example: Build your...               │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 2. インストールとセットアップ

### 2.1 前提条件

本拡張機能を使用する前に、以下をご確認ください：

| 手順 | 要件                               | 説明                                             |
| ---- | ---------------------------------- | ------------------------------------------------ |
| ①    | Anki をインストール                | [Anki をダウンロード](https://apps.ankiweb.net/) |
| ②    | AnkiConnect アドオンをインストール | 以下の手順を参照                                 |
| ③    | AI API キーを取得                  | 少なくとも 1 つの AI プロバイダーを設定          |

### 2.2 AnkiConnect のインストール

**手順：**

1. Anki デスクトップ版を開く
2. **ツール** → **アドオン** をクリック
3. **アドオンを取得** をクリック
4. アドオンコードを入力：`2055492159`
5. **OK** をクリックし、ダウンロード完了を待つ
6. **Anki を再起動**

> ⚠️ **重要**：本拡張機能を使用する際は、Anki が実行中であることを確認してください！

### 2.3 AI API キーの取得

本拡張機能は 3 つの AI プロバイダーに対応しています。いずれか 1 つを選択してください：

#### 方法 1：Google Gemini（推奨 - 無料枠あり）

1. [Google AI Studio](https://makersuite.google.com/app/apikey) にアクセス
2. Google アカウントでログイン
3. **Create API Key** をクリック
4. 生成された API キーをコピー

#### 方法 2：OpenAI GPT

1. [OpenAI Platform](https://platform.openai.com/api-keys) にアクセス
2. アカウントにログインまたは新規登録
3. **Create new secret key** をクリック
4. API キーをコピー

#### 方法 3：Anthropic Claude

1. [Anthropic Console](https://console.anthropic.com/) にアクセス
2. アカウントにログインまたは新規登録
3. API Keys ページに移動
4. API キーを作成してコピー

### 2.4 拡張機能の設定

1. **拡張機能の設定ページを開く**
   - 拡張機能アイコンを右クリック → **オプション** を選択
   - または拡張機能アイコンをクリック → 右上の ⚙️ 設定ボタンをクリック

2. **AI サービスの設定**
   - AI プロバイダーを選択（例：Google Gemini）
   - API キーを貼り付け
   - **接続をテスト** をクリックして設定を確認

3. **Anki 接続の設定**
   - Anki が実行中であることを確認
   - **Anki 接続をテスト** をクリック
   - ✅ 成功メッセージが表示されれば完了

4. **解析テンプレートを作成**（第 4 章参照）

---

## 3. 使い方

### 3.1 方法 1：ポップアップモード

用途：手動で単語を入力、テキストの一括処理

**操作手順：**

```
手順 1                    手順 2                    手順 3
拡張機能アイコンをクリック テキストを入力し「解析」をクリック 「Anki に書き込む」をクリック
    │                        │                        │
    ▼                        ▼                        ▼
┌─────────┐             ┌─────────┐             ┌─────────┐
│ 🔌 アイコン│  ──────►   │ 📝 入力 │  ──────►    │ ✅ 成功  │
│         │             │ vocabulary│             │         │
└─────────┘             │ [解析]  │             └─────────┘
                        └─────────┘
```

**詳細手順：**

1. Chrome ツールバーの **AnkiBeam** アイコンをクリック
2. 入力ボックスに検索したい単語またはフレーズを入力
3. （任意）ドロップダウンメニューから解析テンプレートを選択
4. **「解析」** ボタンをクリック
5. AI の解析が完了するのを待ち、各フィールドが自動入力される
6. 生成されたコンテンツを確認・編集（必要に応じて）
7. **「Anki に書き込む」** ボタンをクリック
8. ✅ 「書き込み成功」メッセージが表示されれば、カードが Anki に追加済み

### 3.2 方法 2：フローティングアシスタントモード

用途：Webページ閲覧中の随時検索、素早いカード作成

**操作手順：**

```
手順 1                    手順 2                    手順 3
Webページでテキストを選択  フローティングボタンをクリック パネルで書き込みを確認
    │                        │                        │
    ▼                        ▼                        ▼
 ─────────               ┌─────────┐             ┌─────────┐
│vocabulary│  ──────►    │ 🔘 ボタン│  ──────►    │ 📋 パネル│
 ─────────               └─────────┘             │ [書き込み]│
                                                 └─────────┘
```

**詳細手順：**

1. 任意のWebページで、検索したいテキストをマウスで **選択** する
2. 選択後、テキストの近くに **フローティングボタン** 🔘 が表示される
3. フローティングボタンをクリック
4. **フローティングパネル** が表示され、AI が自動的に解析を開始
5. 解析完了後、各フィールドの内容を確認
6. （任意）コンテンツを編集またはテンプレートを切り替え
7. **「書き込み」** ボタンをクリック
8. 成功メッセージが表示されれば、カードが追加済み

> 💡 **ヒント**：📌 ピンボタンをクリックするとパネルを固定でき、ページ間を移動してもパネルが消えません。

### 3.3 テンプレートの切り替え

複数の解析テンプレートを作成した場合、いつでも切り替えが可能です：

- **ポップアップ内**：上部のドロップダウンメニューでテンプレートを選択
- **フローティングパネル内**：パネル上部のドロップダウンメニューでテンプレートを選択

テンプレートを切り替えた後、以前の解析結果がある場合は再解析が必要です。

---

## 4. テンプレート設定

### 4.1 解析テンプレートとは？

解析テンプレートでは以下を定義します：

- AI が生成すべきフィールド（例：Word、Meaning、Example）
- これらのフィールドが Anki ノートタイプにどう対応するか
- AI の解析指示（任意）

### 4.2 新しいテンプレートの作成

1. **拡張機能の設定ページ** を開く
2. **「テンプレート管理」** タブに切り替え
3. **「+ 新規テンプレート」** をクリック
4. 以下の情報を入力：

| フィールド     | 説明                      | 例                      |
| -------------- | ------------------------- | ----------------------- |
| テンプレート名 | 識別しやすい名前          | 「英語ボキャブラリー」  |
| 対象デッキ     | Anki のデッキ名           | 「英語::単語」          |
| ノートタイプ   | Anki のノートテンプレート | 「Basic」またはカスタム |

5. **フィールドを追加**：

**「+ フィールドを追加」** をクリックし、各フィールドを設定：

| 設定項目     | 説明                                      |
| ------------ | ----------------------------------------- |
| フィールド名 | Anki ノートタイプのフィールド名と一致必須 |
| 表示名       | UI に表示されるわかりやすい名前           |
| 解析指示     | AI がこのフィールドをどう埋めるか（任意） |

6. **「テンプレートを保存」** をクリック

### 4.3 テンプレート例

#### 英語ボキャブラリーテンプレート

```
テンプレート名：英語ボキャブラリー
対象デッキ：英語::単語
ノートタイプ：Basic-reversed

フィールド設定：
┌──────────────┬───────────────────────────────────────┐
│ フィールド名 │ 解析指示                              │
├──────────────┼───────────────────────────────────────┤
│ Word         │ 入力された単語そのもの                 │
│ Pronunciation│ IPA 発音記号（例：/ˈvɑːkjəb(ə)l/）   │
│ Meaning      │ 日本語の意味（品詞含む）               │
│ Example      │ 1-2 個の例文（日本語訳付き）           │
│ Etymology    │ 語源分析（あれば）                     │
└──────────────┴───────────────────────────────────────┘
```

#### 日本語学習テンプレート

```
テンプレート名：日本語ボキャブラリー
対象デッキ：日本語::語彙
ノートタイプ：Japanese-vocab

フィールド設定：
┌──────────────┬───────────────────────────────────────┐
│ フィールド名 │ 解析指示                              │
├──────────────┼───────────────────────────────────────┤
│ 単語         │ 単語そのもの（日本語）                 │
│ 読み方       │ ひらがな読み                          │
│ 意味         │ 英語または中国語の意味                 │
│ 例文         │ 日本語の例文                          │
│ メモ         │ 使い方のメモ、注意事項                 │
└──────────────┴───────────────────────────────────────┘
```

### 4.4 カスタム AI プロンプト

上級ユーザーは AI の解析プロンプトを完全にカスタマイズできます：

1. テンプレートエディタで **「詳細設定」** を展開
2. **「カスタムプロンプト」** テキストエリアにプロンプトを記述
3. ユーザー入力には `{{INPUT_TEXT}}` プレースホルダーを使用

**例：**

```
あなたはプロの英語語彙教師です。以下の単語を分析してください：

{{INPUT_TEXT}}

以下のJSON形式で出力してください：
{
  "Word": "単語そのもの",
  "Pronunciation": "IPA発音記号",
  "Meaning": "詳細な定義",
  "Example": "2つの例文",
  "Collocations": "よくある組み合わせ"
}
```

---

## 5. 高度な機能

### 5.1 マルチプロバイダーフェイルオーバー

複数の AI プロバイダーを設定できます。システムは以下のように動作します：

- 設定したメインプロバイダーを優先使用
- メインプロバイダーが失敗した場合、バックアッププロバイダーに自動切り替え

**設定方法**：設定ページの AI 設定エリアで、複数のプロバイダーの API キーを設定できます。

### 5.2 ヘルスチェック

設定ページでは、各 AI プロバイダーに **「接続をテスト」** ボタンがあります：

- ✅ **Healthy** - サービス正常
- ⚠️ **Error** - サービス異常、エラー理由を表示
- ❓ **Unknown** - 未テスト

### 5.3 スタイル設定

Anki に書き込むコンテンツのスタイルをカスタマイズできます：

| 設定項目       | 説明                       | デフォルト |
| -------------- | -------------------------- | ---------- |
| フォントサイズ | カード内容のフォントサイズ | 14px       |
| テキストの配置 | 左揃え/中央揃え/右揃え     | 左揃え     |
| 行の高さ       | 行間設定                   | 1.4        |

### 5.4 言語設定

以下のインターフェース言語に対応しています：

- 🇺🇸 English
- 🇨🇳 简体中文
- 🇹🇼 繁體中文
- 🇯🇵 日本語

変更方法：設定ページ → インターフェース設定 → 言語選択

---

## 6. よくある質問

### Q1：Anki に接続できない？

**症状**：「Anki に書き込む」をクリックすると接続失敗エラーが表示される

**解決方法**：

1. ✅ Anki デスクトップ版が実行中であることを確認
2. ✅ AnkiConnect アドオンがインストール済みであることを確認（コード：2055492159）
3. ✅ Anki を再起動して再試行
4. ✅ ファイアウォールが 127.0.0.1:8765 ポートをブロックしていないか確認

### Q2：AI 解析に失敗した？

**症状**：「解析」ボタンをクリック後、長時間応答がないかエラーが発生

**解決方法**：

1. ✅ API キーが正しく設定されているか確認
2. ✅ API キーに十分なクォータがあるか確認
3. ✅ 別の AI プロバイダーに切り替えてみる
4. ✅ ネットワーク接続を確認

### Q3：フローティングアシスタントが表示されない？

**症状**：Webページでテキストを選択してもフローティングボタンが表示されない

**解決方法**：

1. ✅ 設定で「フローティングアシスタント」が有効になっているか確認
2. ✅ Webページをリロードして再試行
3. ✅ 一部のサイト（Chrome 組み込みページなど）では拡張機能のスクリプトがサポートされていません

### Q4：カードのフィールドが空？

**症状**：カードは作成されたがフィールドの内容が空

**解決方法**：

1. ✅ テンプレートのフィールド名が Anki ノートタイプのフィールド名と一致しているか確認
2. ✅ AI の解析結果が各フィールドに正しく入力されているか確認
3. ✅ 正しいノートタイプを選択しているか確認

### Q5：拡張機能を更新するには？

**Chrome ウェブストアからインストールした場合**：自動更新

**手動インストールの場合**：

1. 最新バージョンをダウンロード
2. `chrome://extensions/` を開く
3. 旧バージョンを削除
4. 新バージョンを読み込む

---

## 📞 ヘルプ

その他の問題が発生した場合：

1. [GitHub Issues](https://github.com/novahoo13/ankibeam/issues) を確認
2. 新しい Issue を作成して問題を報告
3. エラーのスクリーンショットと再現手順を添付

---

_AnkiBeam をご利用いただきありがとうございます！学習をお楽しみください！_ 🎓
