# 📖 AnkiBeam 使用手册

**版本**: 1.0  
**最后更新**: 2026 年 1 月

---

## 目录

1. [快速入门](#一快速入门)
2. [安装配置](#二安装配置)
3. [使用方法](#三使用方法)
4. [模板配置](#四模板配置)
5. [高级功能](#五高级功能)
6. [常见问题](#六常见问题)

---

## 一、快速入门

### 30 秒了解 AnkiBeam

AnkiBeam 是一款 Chrome 浏览器扩展，它能够：

✅ **自动解析** - 输入单词，AI 自动生成释义、例句、发音等  
✅ **一键制卡** - 解析结果直接同步到 Anki  
✅ **网页划词** - 在任意网页选中文本，浮动面板即刻弹出

### 工作流程图

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│   📝 输入文本          🤖 AI 解析          📚 写入 Anki     │
│                                                             │
│   "vocabulary"   ──►   Word: vocabulary    ──►   ✅ 成功    │
│                        Reading: /vəˈkæbjəleri/              │
│                        Meaning: 词汇表                      │
│                        Example: Build your...               │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 二、安装配置

### 2.1 前置要求

在使用本扩展之前，请确保：

| 序号 | 要求                  | 说明                                   |
| ---- | --------------------- | -------------------------------------- |
| ①    | 安装 Anki             | [下载 Anki](https://apps.ankiweb.net/) |
| ②    | 安装 AnkiConnect 插件 | 参见下方步骤                           |
| ③    | 获取 AI API Key       | 至少配置一个 AI 服务商                 |

### 2.2 安装 AnkiConnect

**步骤：**

1. 打开 Anki 桌面版
2. 点击菜单栏 **工具** → **插件**
3. 点击 **获取插件**
4. 输入插件代码：`2055492159`
5. 点击 **OK**，等待下载完成
6. **重启 Anki**

> ⚠️ **重要**：每次使用本扩展时，请确保 Anki 处于运行状态！

### 2.3 获取 AI API Key

本扩展支持三种 AI 服务商，选择其中一个即可：

#### 方案一：Google Gemini（推荐 - 有免费额度）

1. 访问 [Google AI Studio](https://makersuite.google.com/app/apikey)
2. 登录你的 Google 账号
3. 点击 **Create API Key**
4. 复制生成的 API Key

#### 方案二：OpenAI GPT

1. 访问 [OpenAI Platform](https://platform.openai.com/api-keys)
2. 登录或注册账号
3. 点击 **Create new secret key**
4. 复制生成的 API Key

#### 方案三：Anthropic Claude

1. 访问 [Anthropic Console](https://console.anthropic.com/)
2. 登录或注册账号
3. 进入 API Keys 页面
4. 创建并复制 API Key

### 2.4 配置扩展

1. **打开扩展设置页面**

   - 右键点击扩展图标 → 选择 **选项**
   - 或点击扩展图标 → 点击右上角 ⚙️ 设置按钮

2. **配置 AI 服务**

   - 选择你的 AI 服务商（如 Google Gemini）
   - 粘贴你的 API Key
   - 点击 **测试连接** 确保配置正确

3. **配置 Anki 连接**

   - 确保 Anki 正在运行
   - 点击 **测试 Anki 连接**
   - 看到 ✅ 成功提示即可

4. **创建解析模板**（见第四章）

---

## 三、使用方法

### 3.1 方式一：Popup 弹窗模式

适用于：手动输入单词、批量处理文本

**操作步骤：**

```
步骤 1                    步骤 2                    步骤 3
点击扩展图标              输入文本，点击「解析」      点击「写入 Anki」
    │                        │                        │
    ▼                        ▼                        ▼
┌─────────┐             ┌─────────┐             ┌─────────┐
│ 🔌 图标 │  ──────►    │ 📝 输入 │  ──────►    │ ✅ 成功  │
│         │             │ vocabulary│             │         │
└─────────┘             │ [解析]  │             └─────────┘
                        └─────────┘
```

**详细步骤：**

1. 点击浏览器工具栏中的 **AnkiBeam** 图标
2. 在输入框中输入要查询的单词或短语
3. （可选）从下拉菜单选择解析模板
4. 点击 **「解析」** 按钮
5. 等待 AI 解析完成，各字段自动填充
6. 检查并编辑生成的内容（如需要）
7. 点击 **「写入 Anki」** 按钮
8. 看到 ✅ "写入成功" 提示，卡片已添加到 Anki

### 3.2 方式二：浮动助手模式

适用于：阅读网页时随时查词、快速制卡

**操作步骤：**

```
步骤 1                    步骤 2                    步骤 3
在网页选中文本            点击浮动按钮              在面板中确认写入
    │                        │                        │
    ▼                        ▼                        ▼
 ─────────               ┌─────────┐             ┌─────────┐
│vocabulary│  ──────►    │ 🔘 按钮 │  ──────►    │ 📋 面板 │
 ─────────               └─────────┘             │ [写入]  │
                                                 └─────────┘
```

**详细步骤：**

1. 在任意网页中，用鼠标 **选中** 你想查询的文本
2. 选中后，文本附近会出现一个 **浮动按钮** 🔘
3. 点击浮动按钮
4. **浮动面板** 弹出，AI 自动开始解析
5. 解析完成后，查看各字段内容
6. （可选）编辑内容或切换模板
7. 点击 **「写入」** 按钮
8. 看到成功提示，卡片已添加

> 💡 **小技巧**：你可以点击 📌 图钉按钮固定面板，这样切换页面时面板不会消失。

### 3.3 模板切换

如果你创建了多个解析模板，可以随时切换：

- **Popup 中**：在顶部下拉菜单选择模板
- **浮动面板中**：在面板顶部下拉菜单选择模板

切换模板后，如果之前已有解析结果，会提示你需要重新解析。

---

## 四、模板配置

### 4.1 什么是解析模板？

解析模板定义了：

- AI 应该生成哪些字段（如 Word、Meaning、Example）
- 这些字段如何映射到 Anki 笔记模板
- AI 的解析指令（可选）

### 4.2 创建新模板

1. 打开 **扩展设置页面**
2. 切换到 **「模板管理」** 标签页
3. 点击 **「+ 新建模板」**
4. 填写以下信息：

| 字段     | 说明              | 示例                 |
| -------- | ----------------- | -------------------- |
| 模板名称 | 便于识别的名称    | "英语单词模板"       |
| 目标牌组 | Anki 中的牌组名称 | "英语学习::单词"     |
| 笔记类型 | Anki 中的笔记模板 | "Basic" 或自定义模板 |

5. **添加字段**：

点击 **「+ 添加字段」**，为每个需要的字段配置：

| 配置项   | 说明                               |
| -------- | ---------------------------------- |
| 字段名称 | 必须与 Anki 笔记模板中的字段名一致 |
| 显示名称 | 在界面上显示的友好名称             |
| 解析指令 | 告诉 AI 如何填充该字段（可选）     |

6. 点击 **「保存模板」**

### 4.3 模板示例

#### 英语单词学习模板

```
模板名称: 英语单词学习
目标牌组: 英语学习::单词
笔记类型: Basic-reversed

字段配置:
┌──────────────┬───────────────────────────────────────┐
│ 字段名称     │ 解析指令                              │
├──────────────┼───────────────────────────────────────┤
│ Word         │ 输入的单词本身                         │
│ Pronunciation│ 国际音标，如 /ˈvɑːkjəb(ə)l/          │
│ Meaning      │ 中文释义，包含词性                     │
│ Example      │ 1-2个例句，带中文翻译                  │
│ Etymology    │ 词根词源分析（如有）                   │
└──────────────┴───────────────────────────────────────┘
```

#### 日语学习模板

```
模板名称: 日语单词
目标牌组: 日本語::語彙
笔记类型: Japanese-vocab

字段配置:
┌──────────────┬───────────────────────────────────────┐
│ 字段名称     │ 解析指令                              │
├──────────────┼───────────────────────────────────────┤
│ 単語         │ 单词本身（日文）                       │
│ 読み方       │ 平假名读音                            │
│ 意味         │ 中文或英文释义                         │
│ 例文         │ 日文例句                              │
│ 备注         │ 用法说明、注意事项                     │
└──────────────┴───────────────────────────────────────┘
```

### 4.4 自定义 AI 提示词

高级用户可以完全自定义 AI 的解析提示词：

1. 在模板编辑页面，展开 **「高级设置」**
2. 在 **「自定义提示词」** 文本框中编写你的提示词
3. 使用 `{{INPUT_TEXT}}` 占位符表示用户输入

**示例：**

```
你是一个专业的英语词汇教师。请分析以下单词：

{{INPUT_TEXT}}

请按照以下JSON格式输出：
{
  "Word": "单词本身",
  "Pronunciation": "美式音标",
  "Meaning": "详细的中英文释义",
  "Example": "2个例句，附中文翻译",
  "Collocations": "常见搭配"
}
```

---

## 五、高级功能

### 5.1 多 AI 服务商切换

你可以配置多个 AI 服务商，系统会：

- 优先使用你设置的主服务商
- 当主服务商失败时，自动切换到备用服务商

**配置方法**：在设置页面的 AI 配置区域，可以配置多个服务商的 API Key。

### 5.2 健康检查

在设置页面，每个 AI 服务商都有一个 **「测试连接」** 按钮：

- ✅ **Healthy** - 服务正常
- ⚠️ **Error** - 服务异常，显示错误原因
- ❓ **Unknown** - 尚未测试

### 5.3 样式配置

你可以自定义写入 Anki 的内容样式：

| 配置项   | 说明               | 默认值 |
| -------- | ------------------ | ------ |
| 字体大小 | 卡片内容的字体大小 | 14px   |
| 文本对齐 | 左对齐/居中/右对齐 | 左对齐 |
| 行高     | 行距设置           | 1.4    |

### 5.4 语言设置

支持以下界面语言：

- 🇨🇳 简体中文
- 🇹🇼 繁體中文
- 🇺🇸 English
- 🇯🇵 日本語

更改方法：设置页面 → 界面设置 → 语言选择

---

## 六、常见问题

### Q1: Anki 连接失败？

**症状**：点击"写入 Anki"时提示连接失败

**解决方案**：

1. ✅ 确保 Anki 桌面版正在运行
2. ✅ 确保已安装 AnkiConnect 插件（代码：2055492159）
3. ✅ 重启 Anki 后重试
4. ✅ 检查防火墙是否阻止了 127.0.0.1:8765 端口

### Q2: AI 解析失败？

**症状**：点击"解析"按钮后长时间无响应或报错

**解决方案**：

1. ✅ 检查 API Key 是否正确配置
2. ✅ 确认 API Key 有足够的配额
3. ✅ 尝试切换到其他 AI 服务商
4. ✅ 检查网络连接

### Q3: 浮动助手没有出现？

**症状**：选中网页文本后没有看到浮动按钮

**解决方案**：

1. ✅ 检查设置中是否启用了"浮动助手"功能
2. ✅ 刷新当前网页后重试
3. ✅ 某些网站（如 Chrome 内置页面）不支持扩展脚本

### Q4: 写入的卡片内容为空？

**症状**：卡片创建成功但字段是空的

**解决方案**：

1. ✅ 检查模板的字段名称是否与 Anki 笔记模板一致
2. ✅ 确保 AI 解析结果已正确填充到各字段
3. ✅ 检查是否选择了正确的笔记类型

### Q5: 如何更新扩展？

**Chrome Web Store 安装**：自动更新

**手动安装**：

1. 下载最新版本
2. 打开 `chrome://extensions/`
3. 删除旧版本
4. 加载新版本

---

## 📞 获取帮助

如果遇到其他问题：

1. 查看 [GitHub Issues](https://github.com/novahoo13/ankibeam/issues)
2. 提交新的 Issue 描述你的问题
3. 附上错误截图和操作步骤

---

_感谢使用 AnkiBeam！祝学习愉快！_ 🎓
