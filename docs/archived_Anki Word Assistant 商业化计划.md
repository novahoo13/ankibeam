# Anki Word Assistant 商业化计划

## 1. 产品现状概览
- 纯前端 Chrome 扩展，核心逻辑集中在 `popup/popup.js` 等文件，依赖浏览器本地存储与 AnkiConnect，本身没有任何服务器端组件。
- AI 请求在前端直接 `fetch` Google/OpenAI/Anthropic，虽在 `utils/storage.js` 做 AES-GCM 加密持久化，但供应商密钥最终仍需在本地解密，无法实现统一成本管控。
- 配置页面 (`options/options.js`) 允许自定义 Prompt 与模型，定位是 BYOK（自带密钥）工具，尚未建立账号、配额、权限等体系。
- `manifest.json` 仅声明基础权限和静态资源，缺乏后台脚本、隐私条款与商业化所需的服务端能力。

## 2. 核心商业化缺口
- 缺少服务器端与身份体系，无法校验用户是否已付费，前端开关易被篡改绕过。
- AI 供应商密钥暴露在客户端，无法提供统一高阶模型、速率限制或配额管理。
- 无日志、埋点与错误追踪，难以衡量活跃度、留存或定位滥用行为。
- 未建设订阅、账单、税务与合规流程，缺少商业版隐私协议与服务条款。
- 纯前端架构无法利用 Chrome Web Store 付费渠道，需要自建网站或服务来交付收费功能。

## 3. 核心改造方案
### 3.1 账号与访问控制
- 接入 Auth0、Firebase Auth，或自建 OAuth2/JWT 服务，提供注册、登录、多端会话管理。
- 扩展启动时校验会话令牌，调用后端验证功能权限，例如通过 `/api/check-permissions` 控制按钮、菜单的可见性。

### 3.2 订阅与计费体系
- 后端维护付费计划、订单、发票及退款流程；前端仅展示后端返回的订阅状态。
- 支持一次性解锁与订阅并存，方便低门槛验证市场，同时为后续分层升级保留空间。

### 3.3 功能分层与配置同步
- 设计免费（每日 20 次基础模型）、专业（无限制 + 全量模型 + 批量处理）、企业（API + 定制 + SLA）三层。
- 后端存储配额与功能列表，扩展根据返回结果决定界面元素与入口。
- 将用户设置同步至云端，支持多设备共享配置、Prompt 模板库等增值能力。
- 预制高级 Prompt、批量制卡、导出与团队共享等高级特性，作为专业版/企业版卖点。

### 3.4 用量监控与运营
- 后端代理所有 AI 请求，集中记录调用量、成功率与成本，实施速率限制与配额扣减。
- 接入 Sentry、Logtail/PostHog 等日志与埋点服务，构建活跃、留存、留资等指标看板。
- 建立客服工单与邮件通知机制，结合用户行为触发续费提醒或试用到期通知。

### 3.5 安全与合规
- 扩展与服务端之间使用短期访问令牌、TLS 固定、请求签名等手段降低被破解风险。
- 准备隐私政策、服务条款、退款政策，并根据目标市场规划 KYC、发票与税务处理。

## 4. 外部服务与技术选型
- **支付/订阅**：Stripe 作为主力（国际订阅与一次性购买），PayPal 作为备选；若面向国内用户，补充支付宝/微信支付方案。
- **身份认证**：Auth0 或 Firebase Auth 快速集成；如自建，可选择 Node.js + JWT + PostgreSQL 方案。
- **基础设施**：将后端托管在 AWS/GCP/Azure，数据层使用 PostgreSQL 或 MongoDB，前端静态资源与 API 配合 Cloudflare/CDN；监控选用 DataDog、New Relic 等。
- **许可证与分发**：自研基于 JWT 的 license 验证，必要时对接 Gumroad、FastSpring 等第三方商城渠道。

## 5. 商业化路线图
### 阶段 1（0-1 个月）：验证付费意愿
- 搭建最小化后端骨架与登录流程，确保扩展能识别用户身份。
- 引入一次性付费解锁（$9.99-$19.99）控制高级模型或批量制卡。
- 上线基础埋点与错误追踪，整理隐私条款、服务协议。

### 阶段 2（1-3 个月）：订阅化与云端能力
- 与 Stripe/PayPal 打通订阅（$4.99/月、$39.99/年），提供 7-14 天试用。
- 后端全面代理 AI 请求，落地配额、速率限制与用量统计；扩展只请求后端接口。
- 上线云端配置同步与 Prompt 模板库，支持多端一致体验。

### 阶段 3（3 个月+）：分层增长与企业化
- 发布免费/专业/企业分层，开放团队共享、API、SLA 等能力。
- 构建运营后台、账单中心、客服工单，完善合规、税务与 KYC 流程。
- 强化安全检测、滥用识别与成本优化策略，确保毛利可控。

## 6. 近期优先事项
- 明确商业目标与定价假设，拉通产品、技术、运营的资源投入。
- 设计后端服务架构与数据模型，确定“账号-订阅-配额”核心表结构与 API 清单。
- 筛选支付、身份、日志等外部服务，发起账号注册与 PoC。
- 梳理现有扩展代码的接口边界，规划前端改造点与灰度发布策略。